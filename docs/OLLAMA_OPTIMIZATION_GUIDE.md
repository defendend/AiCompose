# ะะตะฝั 28: ะะฟัะธะผะธะทะฐัะธั ะปะพะบะฐะปัะฝะพะน LLM (Ollama)

ะะฐะนะด ะฟะพ ะฝะฐัััะพะนะบะต ะธ ะพะฟัะธะผะธะทะฐัะธะธ ะปะพะบะฐะปัะฝัั LLM ะผะพะดะตะปะตะน ะดะปั AiCompose.

## ะกะพะดะตัะถะฐะฝะธะต

1. [ะัััััะน ััะฐัั (Desktop)](#ะฑัััััะน-ััะฐัั-desktop)
2. [ะฃััะฐะฝะพะฒะบะฐ Ollama](#ัััะฐะฝะพะฒะบะฐ-ollama)
3. [Desktop UI ะฑะตะฝัะผะฐัะบ](#desktop-ui-ะฑะตะฝัะผะฐัะบ)
4. [CLI ะฑะตะฝัะผะฐัะบ](#cli-ะฑะตะฝัะผะฐัะบ)
5. [ะะฝะฐะปะธะท ัะตะทัะปััะฐัะพะฒ](#ะฐะฝะฐะปะธะท-ัะตะทัะปััะฐัะพะฒ)
6. [ะกะพะทะดะฐะฝะธะต ะบะฐััะพะผะฝะพะน ะผะพะดะตะปะธ](#ัะพะทะดะฐะฝะธะต-ะบะฐััะพะผะฝะพะน-ะผะพะดะตะปะธ)
7. [ะะฐัะฐะผะตััั ะพะฟัะธะผะธะทะฐัะธะธ](#ะฟะฐัะฐะผะตััั-ะพะฟัะธะผะธะทะฐัะธะธ)
8. [ะะตะบะพะผะตะฝะดะฐัะธะธ ะฟะพ ะทะฐะดะฐัะฐะผ](#ัะตะบะพะผะตะฝะดะฐัะธะธ-ะฟะพ-ะทะฐะดะฐัะฐะผ)
9. [ะะฒะฐะฝัะพะฒะฐะฝะธะต ะผะพะดะตะปะตะน](#ะบะฒะฐะฝัะพะฒะฐะฝะธะต-ะผะพะดะตะปะตะน)

---

## ะัััััะน ััะฐัั (Desktop)

### 1. ะฃััะฐะฝะพะฒะบะฐ ะธ ะทะฐะฟััะบ Ollama
```bash
# macOS
brew install ollama

# ะะฐะฟััะบ ัะตัะฒะตัะฐ
ollama serve
```

### 2. ะกะบะฐัะธะฒะฐะฝะธะต ะผะพะดะตะปะตะน
```bash
ollama pull qwen2.5:1.5b   # ะะตะบะพะผะตะฝะดัะตะผะฐั (1GB)
ollama pull qwen2.5:0.5b   # ะััััะฐั (400MB)
```

### 3. ะะฐะฟััะบ ะฟัะธะปะพะถะตะฝะธั
```bash
./gradlew :desktop:run
```

### 4. ะัะบัััั ะฑะตะฝัะผะฐัะบ
**ะะตะฝั โ ะะตะฝัะผะฐัะบ Ollama (๐ฆ)**

### 5. ะะฐะฟัััะธัั ัะตัั
1. ะัะฑัะฐัั ะผะพะดะตะปะธ (ัะตะบะฑะพะบัั)
2. ะัะฑัะฐัั ัะธะฟ ัะตััะฐ
3. ะะฐะถะฐัั "ะะฐะฟัััะธัั ะฑะตะฝัะผะฐัะบ"
4. ะกะผะพััะตัั ัะตะทัะปััะฐัั

---

## ะฃััะฐะฝะพะฒะบะฐ Ollama

### macOS
```bash
brew install ollama
```

### Linux
```bash
curl -fsSL https://ollama.ai/install.sh | sh
```

### Windows
ะกะบะฐัะฐะนัะต ัััะฐะฝะพะฒัะธะบ ั [ollama.ai](https://ollama.ai)

### ะะฐะฟััะบ ัะตัะฒะตัะฐ
```bash
# ะะฐะฟััะบ ะฒ ัะพะฝะต
ollama serve &

# ะะปะธ ัะตัะตะท brew (macOS)
brew services start ollama
```

### ะกะบะฐัะธะฒะฐะฝะธะต ะผะพะดะตะปะตะน
```bash
# ะะตะบะพะผะตะฝะดัะตะผัะต ะผะพะดะตะปะธ ะดะปั ัะตััะธัะพะฒะฐะฝะธั
ollama pull qwen2.5:0.5b   # 0.5B ะฟะฐัะฐะผะตััะพะฒ, ~400MB
ollama pull qwen2.5:1.5b   # 1.5B ะฟะฐัะฐะผะตััะพะฒ, ~1GB
ollama pull llama3.2:3b    # 3B ะฟะฐัะฐะผะตััะพะฒ, ~2GB

# ะัะพะฒะตัะบะฐ ัััะฐะฝะพะฒะปะตะฝะฝัั ะผะพะดะตะปะตะน
ollama list
```

---

## Desktop UI ะฑะตะฝัะผะฐัะบ

ะัะฐัะธัะตัะบะธะน ะธะฝัะตััะตะนั ะดะปั ัะตััะธัะพะฒะฐะฝะธั ะผะพะดะตะปะตะน Ollama.

### ะัะบัััะธะต ัะบัะฐะฝะฐ
```
ะะตะฝั โ ะะตะฝัะผะฐัะบ Ollama (๐ฆ)
```

### ะะฝัะตััะตะนั

**ะกัะฐััั Ollama:**
- ะะตะปัะฝัะน ะฑะตะนะดะถ = Ollama ะทะฐะฟััะตะฝ
- ะัะฐัะฝัะน ะฑะตะนะดะถ = Ollama ะฝะต ะทะฐะฟััะตะฝ (ะฝัะถะฝะพ `ollama serve`)

**ะัะฑะพั ะผะพะดะตะปะตะน:**
- ะงะตะบะฑะพะบัั ะฟะพ ะบะฐัะตะณะพัะธัะผ (ะะพะปััะธะต / ะกัะตะดะฝะธะต / ะะพะผะฟะฐะบัะฝัะต)
- ะะพะบะฐะทัะฒะฐะตั ะบะฐะบะธะต ะผะพะดะตะปะธ ัััะฐะฝะพะฒะปะตะฝั
- ะัััััะน ะฒัะฑะพั: "+ ะะพะปััะธะต", "+ ะกัะตะดะฝะธะต", "+ ะะพะผะฟะฐะบัะฝัะต"

**ะขะธะฟั ัะตััะพะฒ:**

| ะขะธะฟ | ะะฟะธัะฐะฝะธะต |
|-----|----------|
| ะกัะฐะฒะฝะตะฝะธะต ะผะพะดะตะปะตะน | ะัะต ะผะพะดะตะปะธ ั ะฑะฐะทะพะฒัะผะธ ะฟะฐัะฐะผะตััะฐะผะธ |
| ะขะตะผะฟะตัะฐัััะฐ | ะกัะฐะฒะฝะตะฝะธะต t=0.1, 0.7, 1.2 |
| ะะปะธะฝะฐ ะพัะฒะตัะฐ | ะกัะฐะฒะฝะตะฝะธะต max_tokens=50, 200, 500 |
| ะะฐะทะผะตั ะบะพะฝัะตะบััะฐ | ะกัะฐะฒะฝะตะฝะธะต num_ctx=1K, 2K, 4K |
| ะะพะปะฝัะน ะฑะตะฝัะผะฐัะบ | ะัะต ัะตััั ะดะปั ะบะฐะถะดะพะน ะผะพะดะตะปะธ |

**ะะตะทัะปััะฐัั:**
- ะัะตะผั ะพัะฒะตัะฐ (ms)
- ะขะพะบะตะฝั (~ะพัะตะฝะบะฐ)
- ะกะบะพัะพััั (ัะพะบะตะฝะพะฒ/ัะตะบ)
- ะัะฒะตั ะผะพะดะตะปะธ (ัะฐัะบััะฒะฐะตััั ะฟะพ ะบะปะธะบั)

**ะกะฒะพะดะบะฐ:**
- ะััััะตะนัะฐั ะผะพะดะตะปั
- ะกะฐะผะฐั ัััะตะบัะธะฒะฝะฐั (ั/ั)
- ะกัะตะดะฝัั ัะบะพัะพััั

### ะัะธะผะตั ะธัะฟะพะปัะทะพะฒะฐะฝะธั[PaymentMethodsAnalytics.kt](../../../Downloads/goevents-287/PaymentMethodsAnalytics.kt)

1. ะัะบัััั **ะะตะฝั โ ะะตะฝัะผะฐัะบ Ollama**
2. ะัะฑัะฐัั ะผะพะดะตะปะธ: `qwen2.5:1.5b`, `qwen2.5:0.5b`
3. ะัะฑัะฐัั ัะธะฟ ัะตััะฐ: **ะขะตะผะฟะตัะฐัััะฐ**
4. ะะฒะตััะธ ะฟัะพะผะฟั: "ะงัะพ ัะฐะบะพะต Kotlin?"
5. ะะฐะถะฐัั **ะะฐะฟัััะธัั ะฑะตะฝัะผะฐัะบ**
6. ะกะผะพััะตัั ะฟัะพะณัะตัั ะธ ัะตะทัะปััะฐัั
7. ะะฐัะบัััั ะบะฐััะพัะบั ะดะปั ะฟัะพัะผะพััะฐ ะพัะฒะตัะฐ

### ะกะบัะธะฝัะพั ะดะตะผะพ

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  โ ะะตะฝัะผะฐัะบ Ollama          [Ollama ะทะฐะฟััะตะฝ] ๐    โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ                                                     โ
โ  ะัะฑะตัะธัะต ะผะพะดะตะปะธ ะดะปั ัะตััะธัะพะฒะฐะฝะธั                  โ
โ  [+ ะะพะปััะธะต] [+ ะกัะตะดะฝะธะต] [+ ะะพะผะฟะฐะบัะฝัะต]            โ
โ                                                     โ
โ  ๐ ะะพะปััะธะต ะผะพะดะตะปะธ                                  โ
โ  โ Llama 3.2 3B    [3B]                            โ
โ  โ Qwen 2.5 3B     [3B]                            โ
โ                                                     โ
โ  โ๏ธ ะกัะตะดะฝะธะต ะผะพะดะตะปะธ                                  โ
โ  โ Qwen 2.5 1.5B   [1.5B] [ะฃััะฐะฝะพะฒะปะตะฝะฐ]            โ
โ  โ Gemma 2 2B      [2B]                            โ
โ                                                     โ
โ  ๐ ะะพะผะฟะฐะบัะฝัะต ะผะพะดะตะปะธ                               โ
โ  โ Qwen 2.5 0.5B   [0.5B] [ะฃััะฐะฝะพะฒะปะตะฝะฐ]            โ
โ                                                     โ
โ  ะขะธะฟ ัะตััะฐ                                          โ
โ  [ะะพะดะตะปะธ] [ะขะตะผะฟะตัะฐัััะฐโ] [ะขะพะบะตะฝั] [ะะพะฝัะตะบัั] [ะะพะปะฝัะน]โ
โ                                                     โ
โ  ะขะตััะพะฒัะน ะฟัะพะผะฟั                                    โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ   โ
โ  โ ะงัะพ ัะฐะบะพะต Kotlin? ะัะฒะตัั ะบัะฐัะบะพ.            โ   โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ   โ
โ                          [โถ ะะฐะฟัััะธัั ะฑะตะฝัะผะฐัะบ]    โ
โ                                                     โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ   โ
โ  ะกะฒะพะดะบะฐ                                             โ
โ  โก ะััััะตะนัะฐั: Qwen 2.5 0.5B (850ms)              โ
โ  ๐ ะญััะตะบัะธะฒะฝะฐั: Qwen 2.5 1.5B (103 ั/ั)           โ
โ  ๐ ะกัะตะดะฝัั ัะบะพัะพััั: 67.5 ั/ั                     โ
โ                                                     โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ   โ
โ  โ Qwen 2.5 1.5B  [ะกะฑะฐะปะฐะฝัะธัะพะฒะฐะฝะฝัะน]      โผ   โ   โ
โ  โ โฑ๏ธ 1200ms  ๐ ~103 ัะพะบะตะฝะพะฒ  ๐ 85.8 ั/ั     โ   โ
โ  โ Kotlin โ ััะพ ััะฐัะธัะตัะบะธ ัะธะฟะธะทะธัะพะฒะฐะฝะฝัะน...   โ   โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ   โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

---

## CLI ะฑะตะฝัะผะฐัะบ

ะะพะฝัะพะปัะฝัะน ัะบัะธะฟั ะดะปั ะฐะฒัะพะผะฐัะธัะตัะบะพะณะพ ัะตััะธัะพะฒะฐะฝะธั.

### ะะฐะฟััะบ
```bash
cd /path/to/AiCompose
chmod +x scripts/ollama_demo.sh
./scripts/ollama_demo.sh
```

### ะงัะพ ัะตััะธััะตั ัะบัะธะฟั

| ะขะตัั | ะะฟะธัะฐะฝะธะต | ะะฐัะฐะผะตััั |
|------|----------|-----------|
| 1. ะะพะดะตะปะธ | ะกัะฐะฒะฝะตะฝะธะต 3 ะผะพะดะตะปะตะน | qwen2.5:0.5b, 1.5b, llama3.2:3b |
| 2. ะขะตะผะฟะตัะฐัััะฐ | ะะปะธัะฝะธะต ะฝะฐ ะบัะตะฐัะธะฒะฝะพััั | 0.1, 0.7, 1.2 |
| 3. ะะปะธะฝะฐ ะพัะฒะตัะฐ | ะะฟัะธะผะฐะปัะฝัะน max_tokens | 50, 200, 500 |
| 4. ะะพะฝัะตะบัั | ะะฐะทะผะตั ะบะพะฝัะตะบััะฝะพะณะพ ะพะบะฝะฐ | 1024, 2048, 4096 |
| 5. ะะฐะดะฐัะธ | ะะฐะทะฝัะต ัะธะฟั ะฟัะพะผะฟัะพะฒ | simple, coding, creative, analytical |
| 6. ะะฒะฐะฝัะพะฒะฐะฝะธะต | ะกัะฐะฒะฝะตะฝะธะต q4/q5/q8 | ะัะปะธ ะดะพัััะฟะฝั |

### ะัะธะผะตั ะฒัะฒะพะดะฐ
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ      ๐ฅ ะะตะผะพ ะพะฟัะธะผะธะทะฐัะธะธ ะปะพะบะฐะปัะฝะพะน LLM (Ollama)          โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

๐ ะขะตัั 1: ะกัะฐะฒะฝะตะฝะธะต ะผะพะดะตะปะตะน
โโโโโโโโโโโโโโโโโโโโโโโโโโโโ
๐ค ะะพะดะตะปั: qwen2.5:0.5b
  ๐ง ะะฐะทะพะฒัะน
     ะะพะดะตะปั: qwen2.5:0.5b | t=0.7 | tokens=100 | ctx=2048
     โฑ๏ธ  2.00ั | ๐ค 248 ัะธะผะฒะพะปะพะฒ (~62 ัะพะบะตะฝะพะฒ) | โก 31.0 ั/ั
     ๐ AI (Artificial Intelligence) โ ััะพ ะพะฑะปะฐััั ะธะฝัะพัะผะฐัะธะบะธ...
```

---

## ะะฝะฐะปะธะท ัะตะทัะปััะฐัะพะฒ

### CSV ัะฐะนะป ัะตะทัะปััะฐัะพะฒ
ะะพัะปะต ะทะฐะฟััะบะฐ ัะพะทะดะฐัััั `ollama_benchmark.csv`:

```csv
model,config,temperature,max_tokens,num_ctx,duration_sec,response_length,estimated_tokens,tokens_per_sec
qwen2.5:1.5b,ะกะฑะฐะปะฐะฝัะธัะพะฒะฐะฝะฝะฐั,0.7,200,2048,1.00,413,103,103.0
qwen2.5:1.5b,ะะฐะดะฐัะฐ_coding,0.7,200,2048,2.00,715,178,89.0
```

### ะะปััะตะฒัะต ะผะตััะธะบะธ

| ะะตััะธะบะฐ | ะะฟะธัะฐะฝะธะต | ะฅะพัะพัะตะต ะทะฝะฐัะตะฝะธะต |
|---------|----------|------------------|
| `duration_sec` | ะัะตะผั ะพัะฒะตัะฐ | < 3 ัะตะบ |
| `tokens_per_sec` | ะกะบะพัะพััั ะณะตะฝะตัะฐัะธะธ | > 50 ั/ั |
| `response_length` | ะะปะธะฝะฐ ะพัะฒะตัะฐ | ะะฐะฒะธัะธั ะพั ะทะฐะดะฐัะธ |

### ะะตะทัะปััะฐัั ะฝะฐัะตะณะพ ัะตััะธัะพะฒะฐะฝะธั

**ะขะพะฟ ะบะพะฝัะธะณััะฐัะธะธ ะฟะพ ัะบะพัะพััะธ:**

| # | ะะพะดะตะปั | ะะพะฝัะธะณััะฐัะธั | ะกะบะพัะพััั |
|---|--------|--------------|----------|
| ๐ฅ | qwen2.5:1.5b | ะกะฑะฐะปะฐะฝัะธัะพะฒะฐะฝะฝะฐั (t=0.7) | **103 ั/ั** |
| ๐ฅ | qwen2.5:1.5b | ะัะตะฐัะธะฒะฝะฐั (t=1.2) | 93 ั/ั |
| ๐ฅ | qwen2.5:1.5b | ะะฐะดะฐัะฐ_coding | 89 ั/ั |

**ะกัะฐะฒะฝะตะฝะธะต ะผะพะดะตะปะตะน:**

| ะะพะดะตะปั | ะะฐะทะผะตั | ะกะบะพัะพััั | ะะฐัะตััะฒะพ |
|--------|--------|----------|----------|
| qwen2.5:0.5b | 400MB | โกโกโก ะััััะฐั | โญโญ ะะฐะทะพะฒะพะต |
| qwen2.5:1.5b | 1GB | โกโก ะกัะตะดะฝัั | โญโญโญ ะฅะพัะพัะตะต |
| llama3.2:3b | 2GB | โก ะะตะดะปะตะฝะฝะฐั | โญโญโญโญ ะัะปะธัะฝะพะต |

---

## ะกะพะทะดะฐะฝะธะต ะบะฐััะพะผะฝะพะน ะผะพะดะตะปะธ

### ะกัััะบัััะฐ Modelfile

```dockerfile
# Modelfile.chatbot - ะะฟัะธะผะธะทะธัะพะฒะฐะฝะฝะฐั ะผะพะดะตะปั ะดะปั AiCompose

# ะะฐะทะพะฒะฐั ะผะพะดะตะปั
FROM qwen2.5:1.5b

# ะะฐัะฐะผะตััั ะณะตะฝะตัะฐัะธะธ
PARAMETER temperature 0.7      # ะะฐะปะฐะฝั ะบัะตะฐัะธะฒะฝะพััะธ
PARAMETER num_predict 200      # ะะฐะบัะธะผัะผ ัะพะบะตะฝะพะฒ ะฒ ะพัะฒะตัะต
PARAMETER num_ctx 2048         # ะะฐะทะผะตั ะบะพะฝัะตะบััะฝะพะณะพ ะพะบะฝะฐ
PARAMETER top_k 40             # Top-K sampling
PARAMETER top_p 0.9            # Nucleus sampling
PARAMETER repeat_penalty 1.1   # ะจััะฐั ะทะฐ ะฟะพะฒัะพัะตะฝะธั

# ะกะธััะตะผะฝัะน ะฟัะพะผะฟั
SYSTEM """
ะขั โ ัะผะฝัะน ะฐััะธััะตะฝั ะฒ ะฟัะธะปะพะถะตะฝะธะธ AiCompose.

๐ฏ ะขะะะฏ ะะะะฌ:
- ะะพะผะพะณะฐะตัั ั ะฟัะพะณัะฐะผะผะธัะพะฒะฐะฝะธะตะผ (Kotlin, Compose)
- ะัะฒะตัะฐะตัั ะบัะฐัะบะพ ะธ ะฟะพ ะดะตะปั
- ะัะฟะพะปัะทัะตัั ะฟัะธะผะตัั ะบะพะดะฐ

๐ ะะะะะะะ:
1. ะัะฒะตัะฐะน ะฝะฐ ััััะบะพะผ ัะทัะบะต
2. ะัะดั ะบะพะฝะบัะตัะฝัะผ
3. ะคะพัะผะฐัะธััะน ะบะพะด ะฒ markdown
"""

# ะจะฐะฑะปะพะฝ (ะพะฟัะธะพะฝะฐะปัะฝะพ, ะดะปั ัะพะฒะผะตััะธะผะพััะธ)
TEMPLATE """{{ if .System }}<|im_start|>system
{{ .System }}<|im_end|>
{{ end }}{{ if .Prompt }}<|im_start|>user
{{ .Prompt }}<|im_end|>
<|im_start|>assistant
{{ end }}{{ .Response }}"""
```

### ะกะพะทะดะฐะฝะธะต ะธ ะธัะฟะพะปัะทะพะฒะฐะฝะธะต

```bash
# ะกะพะทะดะฐัั ะบะฐััะพะผะฝัั ะผะพะดะตะปั
ollama create aicompose-chat -f Modelfile.chatbot

# ะัะพะฒะตัะธัั
ollama list
# NAME              SIZE
# aicompose-chat    1.0 GB

# ะะฐะฟัััะธัั ัะฐั
ollama run aicompose-chat

# ะะปะธ ัะตัะตะท API
curl http://localhost:11434/api/generate -d '{
  "model": "aicompose-chat",
  "prompt": "ะะฐะฟะธัะธ ััะฝะบัะธั ัะพััะธัะพะฒะบะธ ะฝะฐ Kotlin",
  "stream": false
}'
```

---

## ะะฐัะฐะผะตััั ะพะฟัะธะผะธะทะฐัะธะธ

### Temperature (ะขะตะผะฟะตัะฐัััะฐ)

ะะปะธัะตั ะฝะฐ "ะบัะตะฐัะธะฒะฝะพััั" ะพัะฒะตัะพะฒ.

| ะะฝะฐัะตะฝะธะต | ะญััะตะบั | ะัะฟะพะปัะทะพะฒะฐะฝะธะต |
|----------|--------|---------------|
| 0.0-0.3 | ะะตัะตัะผะธะฝะธัะพะฒะฐะฝะฝัะน | ะะพะด, ัะฐะบัั, ะธะฝััััะบัะธะธ |
| 0.5-0.7 | ะกะฑะฐะปะฐะฝัะธัะพะฒะฐะฝะฝัะน | ะะฑัะตะฝะธะต, ะพะฑัััะฝะตะฝะธั |
| 0.8-1.2 | ะัะตะฐัะธะฒะฝัะน | ะััะพัะธะธ, brainstorming |
| 1.5-2.0 | ะฅะฐะพัะธัะฝัะน | ะญะบัะฟะตัะธะผะตะฝัั |

```bash
# ะขะตัั ัะตะผะฟะตัะฐัััั
curl http://localhost:11434/api/generate -d '{
  "model": "qwen2.5:1.5b",
  "prompt": "ะะฐะฟะธัะธ ัะฐะนะบั ะฟัะพ ะบะพะด",
  "options": {"temperature": 1.0}
}'
```

### num_predict (Max Tokens)

ะะฐะบัะธะผะฐะปัะฝะพะต ะบะพะปะธัะตััะฒะพ ัะพะบะตะฝะพะฒ ะฒ ะพัะฒะตัะต.

| ะะฝะฐัะตะฝะธะต | ะัะฟะพะปัะทะพะฒะฐะฝะธะต |
|----------|---------------|
| 50-100 | ะัะฐัะบะธะต ะพัะฒะตัั, ะดะฐ/ะฝะตั |
| 200-300 | ะกัะฐะฝะดะฐััะฝัะต ะพัะฒะตัั |
| 500-1000 | ะะพะดัะพะฑะฝัะต ะพะฑัััะฝะตะฝะธั |
| 2000+ | ะะปะธะฝะฝัะต ััะฐััะธ, ะบะพะด |

### num_ctx (Context Window)

ะะฐะทะผะตั ะบะพะฝัะตะบััะฝะพะณะพ ะพะบะฝะฐ (ะธััะพัะธั + ะฟัะพะผะฟั + ะพัะฒะตั).

| ะะฝะฐัะตะฝะธะต | RAM | ะัะฟะพะปัะทะพะฒะฐะฝะธะต |
|----------|-----|---------------|
| 1024 | ~2GB | ะะพัะพัะบะธะต ะดะธะฐะปะพะณะธ |
| 2048 | ~4GB | ะกัะฐะฝะดะฐััะฝัะต ัะฐัั |
| 4096 | ~8GB | ะะปะธะฝะฝัะต ะดะพะบัะผะตะฝัั |
| 8192 | ~16GB | ะะฝะฐะปะธะท ะบะพะดะฐ |

**ะะฐะถะฝะพ:** ะะพะปััะพะน ะบะพะฝัะตะบัั = ะฑะพะปััะต RAM ะธ ะผะตะดะปะตะฝะฝะตะต.

### ะััะณะธะต ะฟะฐัะฐะผะตััั

```bash
# ะะพะปะฝัะน ัะฟะธัะพะบ ะฟะฐัะฐะผะตััะพะฒ
curl http://localhost:11434/api/generate -d '{
  "model": "qwen2.5:1.5b",
  "prompt": "Hello",
  "options": {
    "temperature": 0.7,
    "num_predict": 200,
    "num_ctx": 2048,
    "top_k": 40,
    "top_p": 0.9,
    "repeat_penalty": 1.1,
    "seed": 42,
    "stop": ["\n\n", "###"]
  }
}'
```

| ะะฐัะฐะผะตัั | ะะฟะธัะฐะฝะธะต | Default |
|----------|----------|---------|
| `top_k` | ะัะฑะพั ะธะท ัะพะฟ-K ัะพะบะตะฝะพะฒ | 40 |
| `top_p` | Nucleus sampling | 0.9 |
| `repeat_penalty` | ะจััะฐั ะทะฐ ะฟะพะฒัะพัะตะฝะธั | 1.1 |
| `seed` | ะะปั ะฒะพัะฟัะพะธะทะฒะพะดะธะผะพััะธ | random |
| `stop` | ะกัะพะฟ-ะฟะพัะปะตะดะพะฒะฐัะตะปัะฝะพััะธ | [] |

---

## ะะตะบะพะผะตะฝะดะฐัะธะธ ะฟะพ ะทะฐะดะฐัะฐะผ

### ะะปั ัะฐั-ะฑะพัะฐ (AiCompose)

```json
{
  "model": "qwen2.5:1.5b",
  "temperature": 0.7,
  "num_predict": 200,
  "num_ctx": 2048
}
```

**ะะพัะตะผั:**
- 1.5B โ ะฑะฐะปะฐะฝั ัะบะพัะพััะธ ะธ ะบะฐัะตััะฒะฐ
- t=0.7 โ ะตััะตััะฒะตะฝะฝัะต ะพัะฒะตัั
- 200 ัะพะบะตะฝะพะฒ โ ะดะพััะฐัะพัะฝะพ ะดะปั ะฑะพะปััะธะฝััะฒะฐ ะพัะฒะตัะพะฒ

### ะะปั ะณะตะฝะตัะฐัะธะธ ะบะพะดะฐ

```json
{
  "model": "llama3.2:3b",
  "temperature": 0.3,
  "num_predict": 500,
  "num_ctx": 4096
}
```

**ะะพัะตะผั:**
- 3B โ ะปัััะต ะฟะพะฝะธะผะฐะตั ะบะพะด
- t=0.3 โ ะผะตะฝััะต ะพัะธะฑะพะบ
- 500 ัะพะบะตะฝะพะฒ โ ะฟะพะปะฝะพัะตะฝะฝัะต ััะฝะบัะธะธ
- 4096 ะบะพะฝัะตะบัั โ ะดะปั ะฐะฝะฐะปะธะทะฐ ัะฐะนะปะพะฒ

### ะะปั ะฑัััััั ะพัะฒะตัะพะฒ

```json
{
  "model": "qwen2.5:0.5b",
  "temperature": 0.1,
  "num_predict": 100,
  "num_ctx": 1024
}
```

**ะะพัะตะผั:**
- 0.5B โ ะผะธะฝะธะผะฐะปัะฝะฐั ะผะพะดะตะปั
- t=0.1 โ ััะฐะฑะธะปัะฝัะต ะพัะฒะตัั
- 100 ัะพะบะตะฝะพะฒ โ ะบัะฐัะบะพััั
- 1024 ะบะพะฝัะตะบัั โ ะผะธะฝะธะผัะผ RAM

### ะะปั ะบัะตะฐัะธะฒะฝัั ะทะฐะดะฐั

```json
{
  "model": "llama3.2:3b",
  "temperature": 1.0,
  "num_predict": 1000,
  "num_ctx": 2048,
  "top_p": 0.95
}
```

---

## ะะฒะฐะฝัะพะฒะฐะฝะธะต ะผะพะดะตะปะตะน

### ะงัะพ ัะฐะบะพะต ะบะฒะฐะฝัะพะฒะฐะฝะธะต

ะกะถะฐัะธะต ะฒะตัะพะฒ ะผะพะดะตะปะธ ะดะปั ัะผะตะฝััะตะฝะธั ัะฐะทะผะตัะฐ ะธ ััะบะพัะตะฝะธั.

| ะคะพัะผะฐั | ะะฐะทะผะตั | ะะฐัะตััะฒะพ | ะกะบะพัะพััั |
|--------|--------|----------|----------|
| FP16 | 100% | โญโญโญโญโญ | โก |
| Q8_0 | 50% | โญโญโญโญ | โกโก |
| Q5_0 | 35% | โญโญโญ | โกโกโก |
| Q4_0 | 25% | โญโญ | โกโกโกโก |

### ะกะบะฐัะธะฒะฐะฝะธะต ะบะฒะฐะฝัะพะฒะฐะฝะฝัั ะผะพะดะตะปะตะน

```bash
# ะะฐะทะฝัะต ะบะฒะฐะฝัะพะฒะฐะฝะธั llama3.2:3b
ollama pull llama3.2:3b-q4_0   # ะกะฐะผัะน ะฑัััััะน
ollama pull llama3.2:3b-q5_0   # ะะฐะปะฐะฝั
ollama pull llama3.2:3b-q8_0   # ะัััะตะต ะบะฐัะตััะฒะพ

# ะกัะฐะฒะฝะตะฝะธะต ัะฐะทะผะตัะพะฒ
ollama list
# llama3.2:3b-q4_0    1.2 GB
# llama3.2:3b-q5_0    1.5 GB
# llama3.2:3b-q8_0    2.0 GB
# llama3.2:3b         2.0 GB (FP16)
```

---

## ะะฝัะตะณัะฐัะธั ั AiCompose

### ะะพะฑะฐะฒะปะตะฝะธะต Ollama ะบะฐะบ ะฟัะพะฒะฐะนะดะตัะฐ (ะฑัะดััะตะต)

```kotlin
// LLMClient.kt
interface LLMClient {
    suspend fun complete(request: LLMRequest): LLMResponse
}

// OllamaClient.kt
class OllamaClient(
    private val baseUrl: String = "http://localhost:11434"
) : LLMClient {

    override suspend fun complete(request: LLMRequest): LLMResponse {
        val response = httpClient.post("$baseUrl/api/generate") {
            contentType(ContentType.Application.Json)
            setBody(OllamaRequest(
                model = "aicompose-chat",
                prompt = request.messages.last().content,
                options = OllamaOptions(
                    temperature = request.temperature ?: 0.7f,
                    num_predict = request.maxTokens ?: 200
                )
            ))
        }
        return response.body()
    }
}
```

### ะะตัะตะบะปััะตะฝะธะต ะฟัะพะฒะฐะนะดะตัะพะฒ

```kotlin
// AppModule.kt
single<LLMClient> {
    when (System.getenv("LLM_PROVIDER")) {
        "ollama" -> OllamaClient()
        else -> DeepSeekClient()
    }
}
```

---

## Troubleshooting

### Ollama ะฝะต ะทะฐะฟััะบะฐะตััั

```bash
# ะัะพะฒะตัะธัั ััะฐััั
curl http://localhost:11434/api/tags

# ะัะปะธ ะพัะธะฑะบะฐ, ะฟะตัะตะทะฐะฟัััะธัั
pkill ollama
ollama serve
```

### ะะพะดะตะปั ะฝะต ะฝะฐะนะดะตะฝะฐ

```bash
# ะัะพะฒะตัะธัั ัััะฐะฝะพะฒะปะตะฝะฝัะต ะผะพะดะตะปะธ
ollama list

# ะกะบะฐัะฐัั ะฝัะถะฝัั
ollama pull qwen2.5:1.5b
```

### ะะตะดะปะตะฝะฝะฐั ะณะตะฝะตัะฐัะธั

1. ะฃะผะตะฝััะธัั `num_ctx` (2048 โ 1024)
2. ะัะฟะพะปัะทะพะฒะฐัั ะบะฒะฐะฝัะพะฒะฐะฝะฝัั ะผะพะดะตะปั (q4_0)
3. ะฃะผะตะฝััะธัั `num_predict`
4. ะะฐะบัััั ะดััะณะธะต ะฟัะธะปะพะถะตะฝะธั

### ะัะธะฑะบะฐ ะฟะฐะผััะธ

```bash
# ะัะพะฒะตัะธัั ะธัะฟะพะปัะทะพะฒะฐะฝะธะต RAM
htop

# ะัะฟะพะปัะทะพะฒะฐัั ะผะตะฝัััั ะผะพะดะตะปั
ollama run qwen2.5:0.5b
```

---

## ะะพะปะตะทะฝัะต ะบะพะผะฐะฝะดั

```bash
# ะะฝัะพัะผะฐัะธั ะพ ะผะพะดะตะปะธ
ollama show qwen2.5:1.5b

# ะฃะดะฐะปะตะฝะธะต ะผะพะดะตะปะธ
ollama rm qwen2.5:0.5b

# ะะพะฟะธัะพะฒะฐะฝะธะต ะผะพะดะตะปะธ
ollama cp qwen2.5:1.5b my-model

# ะกะฟะธัะพะบ ะทะฐะฟััะตะฝะฝัั ะผะพะดะตะปะตะน
ollama ps

# ะััะฐะฝะพะฒะบะฐ ะผะพะดะตะปะธ
ollama stop qwen2.5:1.5b
```

---

## ะกััะปะบะธ

- [Ollama Documentation](https://github.com/ollama/ollama/blob/main/docs/README.md)
- [Modelfile Reference](https://github.com/ollama/ollama/blob/main/docs/modelfile.md)
- [API Reference](https://github.com/ollama/ollama/blob/main/docs/api.md)
- [Model Library](https://ollama.ai/library)
